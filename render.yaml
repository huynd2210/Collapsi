services:
  - type: web
    name: collapsi
    env: python
    plan: free
    autoDeploy: true
    buildCommand: pip install -r requirements.txt && pip install cmake ninja && cmake -S cpp -B cpp/build -DCMAKE_BUILD_TYPE=Release && cmake --build cpp/build --config Release --parallel 2
    startCommand: gunicorn -b 0.0.0.0:$PORT app:app
    healthCheckPath: /
    envVars:
      - key: PYTHON_VERSION
        value: 3.11.9
      - key: COLLAPSI_DB
        value: /opt/render/project/src/data/collapsi.db
      - key: COLLAPSI_CPP_EXE
        value: /opt/render/project/src/cpp/build/collapsi_cpp
    disks:
      - name: collapsi-data
        mountPath: /opt/render/project/src/data
        sizeGB: 1


